
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>WebAR with Proximity Detection and Beep</title>
  <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
  <script src="https://cdn.rawgit.com/jeromeetienne/AR.js/2.2.1/aframe/build/aframe-ar.js"></script>
</head>
<body>
  <a-scene embedded arjs="sourceType: webcam;">
    <!-- Object in AR environment -->
    <a-box id="box" position="0 0 -3" rotation="0 45 0" color="#4CC3D9" static-body collider-check></a-box>

    <!-- Camera passthrough -->
    <a-entity camera></a-entity>
  </a-scene>

  <script>
    // Event listener for proximity detection
    AFRAME.registerComponent('collider-check', {
      init: function () {
        var el = this.el;
        this.el.sceneEl.addEventListener('artrackingstart', function (evt) {
          var box = el.object3D;
          var boxPos = new THREE.Vector3();
          var cameraPos = new THREE.Vector3();
          var directionVec = new THREE.Vector3();
          var distance = 1.5; // Adjust distance threshold as needed

          var camera = el.sceneEl.camera;
          var raycaster = new THREE.Raycaster();

          function checkProximity() {
            // Get the position of the box and the camera
            box.getWorldPosition(boxPos);
            camera.getWorldPosition(cameraPos);

            // Calculate the direction from the camera to the box
            directionVec.subVectors(boxPos, cameraPos).normalize();

            // Set the raycaster origin and direction
            raycaster.set(cameraPos, directionVec);

            // Check for intersections with the box
            var intersects = raycaster.intersectObject(box);

            // If the box is in front of the camera
            if (intersects.length > 0 && intersects[0].distance <= distance) {
              // Beep sound
              var context = new AudioContext();
              var oscillator = context.createOscillator();
              oscillator.type = 'sine';
              oscillator.frequency.setValueAtTime(1000, context.currentTime);
              oscillator.connect(context.destination);
              oscillator.start();
              setTimeout(function(){
                oscillator.stop();
              }, 200); // Beep duration in milliseconds
            }
          }

          setInterval(checkProximity, 1000); // Adjust interval as needed
        });
      }
    });
  </script>
</body>
</html>
